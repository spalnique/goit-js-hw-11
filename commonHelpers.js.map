{"version":3,"file":"commonHelpers.js","sources":["../src/img/rejectedIcon.svg","../src/img/izitoast-close.svg","../src/main.js"],"sourcesContent":["export default \"__VITE_ASSET__e571c120__\"","export default \"__VITE_ASSET__40276dd1__\"","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport rejectedIcon from './img/rejectedIcon.svg';\nimport closeIcon from './img/izitoast-close.svg';\n\nclass LoaderSpinner {\n  #previousHTML;\n\n  constructor(parentElemQuery = '') {\n    this.parent = parentElemQuery;\n  }\n  add() {\n    document.querySelector(this.parent).innerHTML =\n      '<div id=\"spinner-container\" style=\"display:flex; flex-direction:column; gap:15px; align-items:center;\"><span class=\"js-processing-request\">Loading images, please wait...</span><span class=\"loader\"></span></div>';\n  }\n\n  remove() {\n    document.querySelector(this.parent).innerHTML = '';\n  }\n}\n\nclass Gallery {\n  #markup;\n  constructor(data = [], requiredProperties = [''], parentElemQuery = '') {\n    this.parent = parentElemQuery;\n    this.rawData = data;\n    this.cleanData = this.#dataFilter(requiredProperties);\n    this.#markup = this.#createMarkup();\n  }\n\n  static testInput(userInput) {\n    if (!userInput.trim()) {\n      return false;\n    }\n    return /^[a-z\\s]+$/gi.test(userInput.trim());\n  }\n\n  #dataFilter(requiredProps) {\n    return this.rawData.map(obj => {\n      const filtered = {};\n      requiredProps.forEach(keyName => {\n        filtered[keyName] = obj[keyName];\n      });\n      return filtered;\n    });\n  }\n\n  #createMarkup() {\n    const markup = this.cleanData\n      .map(\n        x => `<li class=\"js-gallery-item\">\n        <a class=\"js-image-container\" href=\"${x.largeImageURL}\"><img class=\"js-item-image\" src=\"${x.webformatURL}\" alt=\"${x.tags}\" /></a>\n        <ul class=\"js-item-desc\">\n          <li class=\"js-desc-wrapper\"><span class=\"js-desc-prop\">Likes</span><span class=\"js-desc-value\">${x.likes}</span></li>\n          <li class=\"js-desc-wrapper\"><span class=\"js-desc-prop\">Views</span><span class=\"js-desc-value\">${x.views}</span></li>\n          <li class=\"js-desc-wrapper\"><span class=\"js-desc-prop\">Comments</span><span class=\"js-desc-value\">${x.comments}</span></li>\n          <li class=\"js-desc-wrapper\"><span class=\"js-desc-prop\">Downloads</span><span class=\"js-desc-value\">${x.downloads}</span></li>\n        </ul>\n      </li>`\n      )\n      .join('\\n\\n');\n    return markup;\n  }\n  renderGallery() {\n    document.querySelector(this.parent).innerHTML = this.#markup;\n    console.log(this);\n  }\n}\n\n//////////////////////////////////////////////////////////////////////////////////////////\n\nconst refs = {\n  form: document.querySelector('.js-search-form'),\n  input: document.querySelector('.js-search-input'),\n  container: document.querySelector('.js-gallery'),\n};\n\nconst requestUrl = 'https://pixabay.com/api/';\n\nconst requestParams = {\n  key: '42242477-df8643eaa45736c853493b589',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  q: null,\n};\n\nconst spinner = new LoaderSpinner('.js-gallery');\n\nconst iziOptions = {\n  class: 'js-izitoast-message',\n  titleColor: '#FFFFFF',\n  messageColor: '#FFFFFF',\n  messageSize: '16px',\n  position: 'topRight',\n  displayMode: 'replace',\n  pauseOnHover: false,\n  iconUrl: rejectedIcon,\n  close: false,\n\n  buttons: [\n    [\n      `<button type=\"button\" style=\"background-color: transparent;\"><img src=${closeIcon}></button>`,\n      function (instance, toast) {\n        instance.hide({ transitionOut: 'fadeOut' }, toast);\n      },\n    ],\n  ],\n  onOpening: function (_, toast) {\n    refs.container.innerHTML = '';\n    refs.input.blur();\n    refs.input.addEventListener(\n      'focus',\n      () => {\n        iziToast.hide({ transitionOut: 'fadeOut' }, toast);\n      },\n      { once: true }\n    );\n  },\n  onClosed: function (_, toast) {\n    refs.input.removeEventListener(\n      'focus',\n      () => {\n        iziToast.hide({ transitionOut: 'fadeOut' }, toast);\n      },\n      { once: true }\n    );\n  },\n};\n\n// Код нижче був зроблений виключно у дослідницьких цілях\n\nrefs.input.addEventListener('input', e => {\n  if (!/^[a-z\\s]+$/gi.test(e.target.value)) {\n    setTimeout(() => {\n      e.target.value = e.target.value.slice(0, -1);\n    }, 100);\n  }\n});\n\nrefs.form.addEventListener('submit', e => {\n  e.preventDefault();\n  requestParams.q = refs.input.value.trim();\n\n  if (!Gallery.testInput(refs.input.value.trim())) {\n    iziOptions.message =\n      'Try something like \"kitty\", \"best friends\", \"on the Moon\" ;)';\n    iziOptions.backgroundColor = '#e0c34c';\n    iziOptions.progressBarColor = '#f7e28b';\n    iziToast.show(iziOptions);\n    refs.form.reset();\n    return;\n  }\n  spinner.add();\n\n  fetch(`${requestUrl}?${new URLSearchParams(requestParams)}`)\n    .then(response => {\n      if (!response.ok) {\n        throw new Error('Something went wrong!');\n      }\n      return response.json();\n    })\n    .then(data => {\n      if (!data.hits.length) {\n        iziOptions.message =\n          'Sorry, there are no images matching your search query. Please try again!';\n        iziOptions.backgroundColor = '#EF4040';\n        iziOptions.progressBarColor = '#B51B1B';\n        iziToast.show(iziOptions);\n        refs.form.reset();\n        return;\n      }\n      const gallery = new Gallery(\n        data.hits,\n        [\n          'largeImageURL',\n          'webformatURL',\n          'tags',\n          'likes',\n          'views',\n          'comments',\n          'downloads',\n        ],\n        '.js-gallery'\n      );\n      const lightboxInstance = new SimpleLightbox('.js-gallery a', {\n        className: 'lightbox-wrapper',\n      });\n\n      spinner.remove();\n      gallery.renderGallery();\n      lightboxInstance.refresh();\n      refs.form.reset();\n    })\n    .catch(error => console.log(error));\n});\n"],"names":["rejectedIcon","closeIcon","LoaderSpinner","parentElemQuery","__privateAdd","_previousHTML","Gallery","data","requiredProperties","_dataFilter","_createMarkup","_markup","__privateMethod","dataFilter_fn","__privateSet","createMarkup_fn","userInput","__privateGet","requiredProps","obj","filtered","keyName","x","refs","requestUrl","requestParams","spinner","iziOptions","instance","toast","_","iziToast","e","response","gallery","lightboxInstance","SimpleLightbox","error"],"mappings":"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"}